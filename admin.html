<!DOCTYPE html>
<html>
<head>
<title>ADMIN PANEL</title>
<style>
body{
  font-family:Arial;
  background:#f2f2f2;
  padding:30px
}
.box{
  background:#fff;
  padding:25px;
  width:420px;
  border-radius:10px
}
select,input,button{
  padding:10px;
  margin-top:10px;
  width:100%;
  font-size:14px
}
button{
  cursor:pointer
}
</style>
</head>
<body>

<div class="box">
<h3>ADMIN â€“ Reset User Password</h3>

<select id="userList"></select>
<input id="newPass" type="password" placeholder="New Password">
<button onclick="resetPass()">Change Password</button>

<br><br>
<button onclick="logout()">Logout</button>
</div>

<script>
// ðŸ” Admin protection
if(localStorage.getItem("vw_role") !== "admin"){
  alert("Unauthorized");
  location.href = "login.html";
}

// ðŸ“¦ Load users safely
let users = JSON.parse(localStorage.getItem("vw_users"));
if(!users){
  alert("No users found. Please login again.");
  location.href = "login.html";
}

const sel = document.getElementById("userList");
const newPass = document.getElementById("newPass");

// ðŸ‘¥ Fill dropdown
Object.keys(users).forEach(u=>{
  if(u !== "ADMIN"){
    const o = document.createElement("option");
    o.value = u;
    o.text = u;
    sel.appendChild(o);
  }
});

// ðŸ”„ Reset password
function resetPass(){
  if(!sel.value){
    alert("Please select user");
    return;
  }
  if(newPass.value.trim() === ""){
    alert("Password cannot be empty");
    return;
  }

  users[sel.value].password = newPass.value;
  localStorage.setItem("vw_users", JSON.stringify(users));
  alert("Password Updated Successfully");
  newPass.value = "";
}

// ðŸšª Logout
function logout(){
  localStorage.clear();
  location.href = "login.html";
}
</script>

</body>
</html>
