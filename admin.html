<!DOCTYPE html>
<html>
<head>
<title>ADMIN PANEL</title>
<style>
body{
  font-family: Arial;
  background:#f2f2f2;
  padding:30px;
}
.box{
  background:#fff;
  padding:25px;
  width:420px;
  border-radius:10px;
}
select,input,button{
  padding:10px;
  margin-top:10px;
  width:100%;
  font-size:14px;
}
button{
  cursor:pointer;
}
hr{
  margin:20px 0;
}
</style>
</head>
<body>

<div class="box">
  <h3>ADMIN ‚Äì User Management</h3>

  <!-- CREATE USER -->
  <input id="newUser" placeholder="Username">
  <input id="newPassCreate" type="password" placeholder="Password">
  <select id="newRole">
    <option value="user">User</option>
    <option value="admin">Admin</option>
  </select>
  <button onclick="addUser()">Add User</button>

  <hr>

  <!-- RESET PASSWORD -->
  <select id="userList"></select>
  <input id="newPass" type="password" placeholder="New Password">
  <button onclick="resetPass()">Change Password</button>

  <hr>

  <!-- DELETE USER -->
  <button onclick="deleteUser()">Delete Selected User</button>

  <hr>

  <button onclick="logout()">Logout</button>
</div>

<script>
// üîê ADMIN PROTECTION
if(localStorage.getItem("vw_role") !== "admin"){
  location.href = "login.html";
}

// üì¶ LOAD USERS (CREATE DEFAULT IF EMPTY)
let users = JSON.parse(localStorage.getItem("vw_users"));

if(!users){
  users = {
    "giri": { password: "giri1234", role: "user" },
    "ismail": { password: "1234", role: "user" },
    "admin": { password: "admin123", role: "admin" }
  };
  localStorage.setItem("vw_users", JSON.stringify(users));
}

// üîÑ RENDER USER DROPDOWN
const sel = document.getElementById("userList");
function renderUsers(){
  sel.innerHTML = "";
  for(let u in users){
    if(users[u].role === "user"){
      const o = document.createElement("option");
      o.value = u;
      o.text = u;
      sel.appendChild(o);
    }
  }
}
renderUsers();

// ‚ûï ADD USER
function addUser(){
  const u = newUser.value.trim();
  const p = newPassCreate.value.trim();
  const r = newRole.value;

  if(!u || !p){
    alert("Username & password required");
    return;
  }
  if(users[u]){
    alert("User already exists");
    return;
  }

  users[u] = { password: p, role: r };
  localStorage.setItem("vw_users", JSON.stringify(users));

  newUser.value = "";
  newPassCreate.value = "";

  renderUsers();
  alert("User created successfully");
}

// üîÑ RESET PASSWORD
function resetPass(){
  if(!sel.value){
    alert("Select user");
    return;
  }
  if(newPass.value.trim() === ""){
    alert("Password cannot be empty");
    return;
  }

  users[sel.value].password = newPass.value;
  localStorage.setItem("vw_users", JSON.stringify(users));

  newPass.value = "";
  alert("Password updated");
}

// ‚ùå DELETE USER
function deleteUser(){
  if(!sel.value) return;
  if(!confirm("Delete user?")) return;

  delete users[sel.value];
  localStorage.setItem("vw_users", JSON.stringify(users));
  renderUsers();
}

// üö™ LOGOUT (SAFE)
function logout(){
  localStorage.removeItem("vw_user");
  localStorage.removeItem("vw_role");
  location.href = "login.html";
}
</script>

</body>
</html>
